<?xml version="1.0"?>
<ScriptPortable xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ViewName>AGA_R_RELATORIOS.GRID</ViewName>
  <EntityName>R_RELATORIOS</EntityName>
  <Level>Benner</Level>
  <Scripts>
    <ScriptItemPortable>
      <FunctionName>Load</FunctionName>
      <LanguageName>IronPython</LanguageName>
      <SourceCode>import clr
clr.AddReference("Benner.Corporativo.Wes.WebApp")
from Benner.Tecnologia.Common.Exceptions import CancelledOperationException
from Benner.Corporativo.Wes.WebApp.Common import ReportUtilsERP
from Benner.Corporativo.Wes.WebApp.Common import ReportFormatERP

def Load(widget):
    # Deve ter pelo menos uma linha de código para se fazer uma definição de função
    nada = ""
    
def ConfigureReportCommand(command, entity, ReportFormatERP):
    # Esta função é utilizada pelos comandos de Emissão e Exportação do relatório

    try:
        ReportUtilsERP.ConfigureReportCommand(command, entity, ReportFormatERP)
    except Exception, e:
        raise CancelledOperationException(e.__str__())</SourceCode>
    </ScriptItemPortable>
    <ScriptItemPortable>
      <FunctionName>OnCMD_EMITIRExecute</FunctionName>
      <LanguageName>IronPython</LanguageName>
      <SourceCode>def OnCMD_EMITIRExecute(command, Entity):
    ConfigureReportCommand(command, Entity, ReportFormatERP.PDF)</SourceCode>
    </ScriptItemPortable>
    <ScriptItemPortable>
      <FunctionName>OnCMD_ExportarCSVExecute</FunctionName>
      <LanguageName>IronPython</LanguageName>
      <SourceCode>def OnCMD_ExportarCSVExecute(command, entity):
    ConfigureReportCommand(command, entity, ReportFormatERP.CSV)</SourceCode>
    </ScriptItemPortable>
    <ScriptItemPortable>
      <FunctionName>OnCMD_ExportarTxtExecute</FunctionName>
      <LanguageName>IronPython</LanguageName>
      <SourceCode>def OnCMD_ExportarTxtExecute(command, entity):
    ConfigureReportCommand(command, Entity, ReportFormatERP.TXT)</SourceCode>
    </ScriptItemPortable>
    <ScriptItemPortable>
      <FunctionName>OnCMD_ExportarXLSExecute</FunctionName>
      <LanguageName>IronPython</LanguageName>
      <SourceCode>def OnCMD_ExportarXLSExecute(command, entity):
    ConfigureReportCommand(command, entity, ReportFormatERP.XLSX)</SourceCode>
    </ScriptItemPortable>
    <ScriptItemPortable>
      <FunctionName>OnCMD_ExportarTXTExecute</FunctionName>
      <LanguageName>IronPython</LanguageName>
      <SourceCode>def OnCMD_ExportarTXTExecute(command, entity):
    ConfigureReportCommand(command, entity, ReportFormatERP.TXT)</SourceCode>
    </ScriptItemPortable>
  </Scripts>
</ScriptPortable>