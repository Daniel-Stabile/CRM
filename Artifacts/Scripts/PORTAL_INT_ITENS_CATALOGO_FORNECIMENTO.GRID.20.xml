<?xml version="1.0"?>
<ScriptPortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ViewName>PORTAL_INT_ITENS_CATALOGO_FORNECIMENTO.GRID</ViewName>
  <EntityName>CP_CATALOGOFORNECIMENTOITENS</EntityName>
  <Level>Benner</Level>
  <Scripts>
    <ScriptItemPortable>
      <FunctionName>OnPESQUISARPORFilter</FunctionName>
      <LanguageName>IronPython</LanguageName>
      <SourceCode>def OnPESQUISARPORFilter(args):
    from Benner.Tecnologia.Common import WhereClause
    from Benner.Tecnologia.Common import Parameter    
    
    args.WhereClause.Clear();
    
    if(not args.Entity["NOME"].IsNull):
        args.WhereClause.AddWhereClause("A.PRODUTOPAI IN (SELECT HANDLE FROM PD_PRODUTOSPAI WHERE NOME LIKE :NOME )", Parameter("NOME", "%"+args.Entity["NOME"].Value+"%"))    

    if(not args.Entity["VALORUNITARIODE"].IsNull):        
        args.WhereClause.AddWhereClause(" A.VALORUNITARIOCATALOGO &gt;= :DE", Parameter("DE", args.Entity["VALORUNITARIODE"].GetDecimal()))
        
    if(not args.Entity["VALORUNITARIOATE"].IsNull):        
        args.WhereClause.AddWhereClause(" A.VALORUNITARIOCATALOGO &lt;= :ATE", Parameter("ATE", args.Entity["VALORUNITARIOATE"].GetDecimal())) 
        
    if(not args.Entity["CODIGO"].IsNull):
        args.WhereClause.AddWhereClause(" A.PRODUTOPAI IN (SELECT HANDLE FROM PD_PRODUTOSPAI WHERE CODIGO = :CODIGO )", Parameter("CODIGO", args.Entity["CODIGO"].Value))    
        
    if(not args.Entity["CODIGOREFERENCIA"].IsNull):
        args.WhereClause.AddWhereClause(" A.PRODUTOPAI IN (SELECT HANDLE FROM PD_PRODUTOSPAI WHERE CODIGOREFERENCIA LIKE :CODIGOREFERENCIA )", Parameter("CODIGOREFERENCIA", "%"+args.Entity["CODIGOREFERENCIA"].Value+"%"))
        
    if(not args.Entity["FAMILIA"].IsNull):
        args.WhereClause.AddWhereClause(" A.FAMILIA IN ("+args.Entity["FAMILIA"].GetString().replace("|_|",",").replace("|_","")+")") 
            
    if(not args.Entity["UNIDADE"].IsNull):
        args.WhereClause.AddWhereClause(" A.UNIDADE IN ("+args.Entity["UNIDADE"].GetString().replace("|_|",",").replace("|_","")+")")
            
    if(not args.Entity["DESCRICAO"].IsNull):
        args.WhereClause.AddWhereClause(" A.CATALOGOFORNECIMENTO IN (SELECT HANDLE FROM CP_CATALOGOSFORNECIMENTO WHERE DESCRICAO LIKE :NOME )", Parameter("NOME", "%"+args.Entity["DESCRICAO"].Value+"%"))    
        
    if(not args.Entity["FORNECEDOR"].IsNull):
        args.WhereClause.AddWhereClause(" A.CATALOGOFORNECIMENTO IN (SELECT HANDLE FROM CP_CATALOGOSFORNECIMENTO WHERE FORNECEDOR IN (" + args.Entity["FORNECEDOR"].GetString().replace("|_|",",").replace("|_","") + " )) ")
</SourceCode>
    </ScriptItemPortable>
  </Scripts>
</ScriptPortable>