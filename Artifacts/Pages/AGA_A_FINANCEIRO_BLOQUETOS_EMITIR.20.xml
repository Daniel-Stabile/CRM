<?xml version="1.0"?>
<PagePortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Title>Boletos bancários</Title>
  <Url>~/aga/a/financeiro/Officebanking/Bloquetos.aspx</Url>
  <AutoGenerated>true</AutoGenerated>
  <EntityPermissionId />
  <TemplateId>WIZARD</TemplateId>
  <Details />
  <Id>AGA_A_FINANCEIRO_BLOQUETOS_EMITIR</Id>
  <Level>Benner</Level>
  <CodeFile />
  <CodeInherits>aga.a.Financeiro.OfficeBanking.BloquetosBancarios,Benner.Corporativo.Wes.WebApp</CodeInherits>
  <Widgets>
    <PageWidgetPortable>
      <Id>BLOQUETOSBANCRIOS</Id>
      <Title>Boletos</Title>
      <Order>10</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon>fa fa-barcode</FontIcon>
      <Subtitle>filtros</Subtitle>
      <ChromeState>Fixed</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>AjaxForm</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<AjaxFormAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>false</CanUpdate>
  <CanInsert>true</CanInsert>
  <EntityViewName>WEB_FN_BLOQUETOS.CUSTOM.FORM</EntityViewName>
  <FormMode>0</FormMode>
  <IncludeRecordInRecentItems>false</IncludeRecordInRecentItems>
  <UserDefinedCommandsVisible>true</UserDefinedCommandsVisible>
</AjaxFormAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
    <PageWidgetPortable>
      <Id>FILTROS</Id>
      <MasterWidgetId>BLOQUETOSBANCRIOS</MasterWidgetId>
      <Title>Parcelas</Title>
      <Order>20</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>AjaxForm</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<AjaxFormAttributes>
  <CanDelete>true</CanDelete>
  <CanUpdate>true</CanUpdate>
  <CanInsert>true</CanInsert>
  <EntityViewName>WEB_FN_BLOQUETOS_FILTROS.FORM</EntityViewName>
  <FormMode>0</FormMode>
  <IncludeRecordInRecentItems>false</IncludeRecordInRecentItems>
  <UserDefinedCommandsVisible>true</UserDefinedCommandsVisible>
</AjaxFormAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
    <PageWidgetPortable>
      <Id>TTULOS</Id>
      <Title>Títulos</Title>
      <Order>30</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>SimpleGrid</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<SimpleGridAttributes>
  <CanDelete>true</CanDelete>
  <CanUpdate>true</CanUpdate>
  <CanInsert>true</CanInsert>
  <EntityViewName>AGA_A_FN_BLOQUETOS_TITULOS.DATASOURCE.GRID</EntityViewName>
  <Mode>0</Mode>
  <UserDefinedSelectColumnVisible>true</UserDefinedSelectColumnVisible>
  <UserDefinedPageSize>20</UserDefinedPageSize>
  <SystemFilterOnly>false</SystemFilterOnly>
  <DisplayRowCommand>false</DisplayRowCommand>
  <CompanyFilterMode>1</CompanyFilterMode>
  <ShowExport>false</ShowExport>
  <UserDefinedDisableRowSelection>false</UserDefinedDisableRowSelection>
</SimpleGridAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
  </Widgets>
  <Resources>
    <PageResourcePortable>
      <Id>2F43B135D1044D31A69AA9050A9B879C</Id>
      <ResourceType>JavaScript</ResourceType>
      <Content><![CDATA[//Armazenamento temporário dos itens selecionados
var selecionados = [];

var toolBarFiltrosTopo = document.getElementById('ctl00_Main_FILTROS_toolbar');
var btnProximoFiltrosTopo = $(toolBarFiltrosTopo).children(".btn-save")[0];

function beforeAsyncPostBack() {
    var checkados = $('[type=checkbox]:checked');
    $.each(checkados, function(i, chk){
        var hnd = $(chk).closest('tr').attr('handle');
        if(hnd !== '' && (selecionados.indexOf(hnd) <0 ) )
        {
            selecionados.push(hnd);
            $('#ctl00_Main_BLOQUETOSBANCRIOS_SELECIONADOS_HiddenField').val(selecionados.join(","));
        }
    });
}

function afterAsyncPostBack() {
    // Trocar ordem de botões no Filtro
    if($('#ctl00_Main_FILTROS_toolbar .btn-save').length > 0)
        $('#ctl00_Main_FILTROS_toolbar .btn-save').remove();
    
    if($('#ctl00_Main_FILTROS_toolbar').length > 0)
        document.getElementById('ctl00_Main_FILTROS_toolbar').append(btnProximoFiltrosTopo);
        
    if($(btnProximoFiltrosTopo).length >0 )
        $(btnProximoFiltrosTopo).attr("href", "javascript:__doPostBack('ctl00$Main$FILTROS', 'Save')");
    
    if ($('#ctl00_Main_FILTROS_FormContainer .commands-bar').length > 0) {
        $($(document.getElementById('ctl00_Main_FILTROS_FormContainer')).children(".commands-bar")[0]).remove();
    }
    // Fim

    var seletor = 'tr[handle="{0}"] > td > label > [type=checkbox]';
    
    for (var i = 0; i < selecionados.length; i++) {
        var chk = $(seletor.replace('{0}', selecionados[i]));
        if(chk.length > 0) {
            chk.prop('checked', true);
        }
    }
    
    VerificarTodosSelecionados();
}

Sys.Application.add_init(appl_init);
function appl_init() {
    var pgRegMgr = Sys.WebForms.PageRequestManager.getInstance();
    pgRegMgr.add_beginRequest(BeginHandler);
    pgRegMgr.add_endRequest(EndHandler);
}

function BeginHandler() {
    beforeAsyncPostBack();
}

function EndHandler() {           
    afterAsyncPostBack();
}

function VerificarTodosSelecionados(){
    console.log(selecionados);
    //Se o todas as linhas estiverem marcadas marcar tbm o chk do cabeçalho da tabela
    var tableRows = $('#ctl00_Main_TTULOS_SimpleGrid tr');
    
    $('th > label > [type=checkbox]').prop('checked', tableRows.length == ($('td > label > [type=checkbox]:checked').length +1));
    
}

$(function(){
    $(document).on('click', function(e){
        if (e.originalEvent.srcElement !== null && e.originalEvent.srcElement !== undefined) {
            if (e.originalEvent.srcElement.type == 'checkbox') {
                var handle = $(e.originalEvent.srcElement).closest('tr').attr('handle');
                
                if (!e.originalEvent.srcElement.checked && handle !== '') {
                    if(handle == undefined){
                        selecionados = [];
                        $('#ctl00_Main_BLOQUETOSBANCRIOS_SELECIONADOS_HiddenField').val(null);
                    }
                    RemoverSelecionado(handle);
                }
                else if (selecionados.indexOf(handle) <0) {
                    selecionados.push(handle);
                    $('#ctl00_Main_BLOQUETOSBANCRIOS_SELECIONADOS_HiddenField').val(selecionados.join(","));
                }
                
                VerificarTodosSelecionados();
                beforeAsyncPostBack();
            }
        }
    })
    
    function RemoverSelecionado(hnd){
        
        var index = selecionados.indexOf(hnd);
        if (index > -1) {
            selecionados.splice(index, 1);
            
        }
        VerificarTodosSelecionados();
    }
    
})
]]></Content>
      <Level>Benner</Level>
    </PageResourcePortable>
    <PageResourcePortable>
      <Id>56514B791D114666ACD5D045AD031B46</Id>
      <ResourceType>CSS</ResourceType>
      <Content><![CDATA[.table.table-hover.simple-grid td{
    cursor: default!important;
}
.table >tbody >tr >td {
    padding: 3px!important;
}

.table a:hover {
    cursor: default!important;
    text-decoration: none!important
}
]]></Content>
      <Level>Benner</Level>
    </PageResourcePortable>
  </Resources>
</PagePortable>