<?xml version="1.0"?>
<PagePortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Title>Aglutinador Documentos CRE</Title>
  <Url>~/Erp/Financeiro/AglutinadorCRE/Geral.aspx</Url>
  <AutoGenerated>true</AutoGenerated>
  <EntityPermissionId />
  <TemplateId />
  <Details />
  <Id>ERP_FINANCEIRO_AGLUTINADORCRE_GERAL</Id>
  <Level>Benner</Level>
  <CodeFile>~/Erp/Financeiro/AglutinadorCRE/Geral.aspx.cs</CodeFile>
  <CodeInherits>AglutinadorCREGeralPage</CodeInherits>
  <Widgets>
    <PageWidgetPortable>
      <Id>DOCUMENTOS</Id>
      <Title>Contas a receber</Title>
      <Order>10</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>SimpleGrid</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<SimpleGridAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>true</CanUpdate>
  <CanInsert>true</CanInsert>
  <EntityViewName>FN_DOCUMENTOS.AGLUTINADORCRE.GRID</EntityViewName>
  <DefaultFilterName>Filtro Aglutinador CRE</DefaultFilterName>
  <Mode>4</Mode>
  <UserDefinedSelectColumnVisible>true</UserDefinedSelectColumnVisible>
  <UserDefinedPageSize>50</UserDefinedPageSize>
  <SystemFilterOnly>false</SystemFilterOnly>
  <DisplayRowCommand>true</DisplayRowCommand>
  <CompanyFilterMode>1</CompanyFilterMode>
  <ShowExport>true</ShowExport>
  <UserDefinedDisableRowSelection>true</UserDefinedDisableRowSelection>
</SimpleGridAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
  </Widgets>
  <Resources>
    <PageResourcePortable>
      <Id>C560FC10C71649808E5DAF7B5E980A9E</Id>
      <ResourceType>JavaScript</ResourceType>
      <Content><![CDATA[function afterAsyncPostBack() {
            $('input[type="checkbox"]').on('click', function () {
                inicializaCMD_SALVAR();
                var valorTotal = 0;
                $('input[type="checkbox"]:checked:not(#ctl00_Main_PARCELAS_SimpleGrid_ctl01_SelectAllCheckBoxHeader)').each(function () {
                    if(this.name.includes('CONTABILIZADO') || this.id == 'ctl00_Main_DOCUMENTOS_SimpleGrid_ctl01_SelectAllCheckBoxHeader')
                      return;
                    parentTR = $(this).parents('tr:eq(0)');

                    TDValor = $(parentTR).children('td[data-field="VALORLIQUIDO"]:first');

                    strValor = $(TDValor).children().text().replace(/[R$\s]+/, '');
                    strValor = strValor.replaceAll('.', '');
                    strValor = strValor.replace(',', '.');

                    valorTotal += parseFloat(strValor);
                    if (valorTotal > 0) {
                        valorFormatado = 'R$ ' + mascaraValor(valorTotal.toFixed(2));
                        $(".btn.command-action.custom-action.blue").each(function(btn){
                         this.innerHTML = "<i class='fa fa-check btn-action'></i> Aglutinar (" + valorFormatado + ")";
                        })
                    }
                });
            });
          }

          function inicializaCMD_SALVAR() {
               $(".btn.command-action.custom-action.blue").each(function(btn){
              this.innerHTML = "<i class='fa fa-check btn-action'></i> Aglutinar"
            })
          }

          function mascaraValor(valor) {
              valor = valor.toString().replace(/\D/g, "");
              valor = valor.toString().replace(/(\d)(\d{8})$/, "$1.$2");
              valor = valor.toString().replace(/(\d)(\d{5})$/, "$1.$2");
              valor = valor.toString().replace(/(\d)(\d{2})$/, "$1,$2");
              return valor;
          }
          Sys.Application.add_init(appl_init);
          function appl_init() {
            var pgRegMgr = Sys.WebForms.PageRequestManager.getInstance();
            pgRegMgr.add_beginRequest(EndHandler);
            pgRegMgr.add_endRequest(EndHandler);
          }

          $(function(){
            afterAsyncPostBack();
          })

          function EndHandler() {
            afterAsyncPostBack();
          }
]]></Content>
      <Level>Benner</Level>
    </PageResourcePortable>
  </Resources>
</PagePortable>