<?xml version="1.0"?>
<PagePortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Title>Selecionar contratos</Title>
  <Url>~/aga/a/materiais/recebimentoFisico/selecionarContratos.aspx</Url>
  <AutoGenerated>true</AutoGenerated>
  <EntityPermissionId />
  <TemplateId />
  <Details />
  <Id>AGA_A_MATERIAIS_RECEBIMENTOFISICO_SELECIONARCONTRATOS</Id>
  <Level>Benner</Level>
  <CodeFile />
  <CodeInherits>Benner.Corporativo.Wes.WebApp.aga.a.materiais.recebimentoFisico.SelecionarContratos</CodeInherits>
  <Widgets>
    <PageWidgetPortable>
      <Id>SELECIONARCONTATROS</Id>
      <Title>Selecionar Contratos</Title>
      <Order>10</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>SimpleGrid</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<SimpleGridAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>false</CanUpdate>
  <CanInsert>false</CanInsert>
  <EntityViewName>CONSULTA_SELECIONARCONTRATOS.DATASOURCE.GRID</EntityViewName>
  <DefaultFilterName>BuscarContratos</DefaultFilterName>
  <Mode>2</Mode>
  <UserDefinedSelectColumnVisible>true</UserDefinedSelectColumnVisible>
  <UserDefinedPageSize>10</UserDefinedPageSize>
  <SystemFilterOnly>false</SystemFilterOnly>
  <DisplayRowCommand>true</DisplayRowCommand>
  <CompanyFilterMode>1</CompanyFilterMode>
  <ShowExport>true</ShowExport>
  <UserDefinedDisableRowSelection>true</UserDefinedDisableRowSelection>
</SimpleGridAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
  </Widgets>
  <Resources>
    <PageResourcePortable>
      <Id>C192A015259B4397979840079A1A48EA</Id>
      <ResourceType>JavaScript</ResourceType>
      <Content><![CDATA[const conversorDecimal = value => currency(value, { separator: '.', decimal: ',', precision: 4 });

const AtualizarQuantidadeJSONItens = (item) => {
    var listaItens = JSON.parse($("#JsonListaItens").val());

    var handleItem = $(item).attr('name').split('$')[1];
    var indexItemJSON = listaItens.findIndex(item => item.Handle === handleItem);
    listaItens[indexItemJSON].Quantidade = conversorDecimal($(item).val()).value;

    $("#JsonListaItens").val(JSON.stringify(listaItens));
};

const MapearItensParaJSON = () => {
    $("#SELECIONARCONTATROS input[name*='QTDE_RECEBIDA']").blur(function () { AtualizarQuantidadeJSONItens(this); });

    var listaItens = JSON.parse($("#JsonListaItens").val());

    $("#SELECIONARCONTATROS input[name*='QTDE_RECEBIDA']").map(function () {
        var handleItem = $(this).attr('name').split('$')[1];
        var indexItemJSON = listaItens.findIndex(item => item.Handle === handleItem);

        if (indexItemJSON > -1)
            $(this).val(conversorDecimal(listaItens[indexItemJSON].Quantidade).format());
        else
            listaItens.push({
                Handle: handleItem,
                Quantidade: conversorDecimal($(this).val()).value
            });
    });

    $("#JsonListaItens").val(JSON.stringify(listaItens));
};

$(Sys.WebForms.PageRequestManager.getInstance().add_endRequest(MapearItensParaJSON));
]]></Content>
      <Level>Benner</Level>
    </PageResourcePortable>
    <PageResourcePortable>
      <Id>3A693658419744B89FCC9981A549EC91</Id>
      <ResourceType>CSS</ResourceType>
      <Content><![CDATA[[id^="QTDE_RECEBIDA$"] {
    width: 150px;
}
]]></Content>
      <Level>Benner</Level>
    </PageResourcePortable>
  </Resources>
</PagePortable>