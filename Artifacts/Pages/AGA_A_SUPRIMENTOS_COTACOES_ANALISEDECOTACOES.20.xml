<?xml version="1.0"?>
<PagePortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Title>Análise de Cotações</Title>
  <Url>~/aga/a/suprimentos/cotacoes/AnaliseDeCotacoes.aspx</Url>
  <AutoGenerated>true</AutoGenerated>
  <EntityPermissionId />
  <TemplateId />
  <Details />
  <Id>AGA_A_SUPRIMENTOS_COTACOES_ANALISEDECOTACOES</Id>
  <Level>Benner</Level>
  <CodeFile />
  <CodeInherits>Benner.Corporativo.Wes.WebApp.aga.a.suprimentos.cotacoes.AnaliseDeCotacoes</CodeInherits>
  <Widgets>
    <PageWidgetPortable>
      <Id>CRITRIOSDESUGESTO</Id>
      <Title>Análise de cotações</Title>
      <Order>10</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle>Após preencher os critérios de seleção clique em Sugerir para prosseguir com a análise.</Subtitle>
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>AjaxForm</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<AjaxFormAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>true</CanUpdate>
  <CanInsert>true</CanInsert>
  <EntityViewName>CP_VT_CRITERIOSANALISECOTACOES.FORM</EntityViewName>
  <FormMode>0</FormMode>
  <IncludeRecordInRecentItems>false</IncludeRecordInRecentItems>
  <UserDefinedCommandsVisible>true</UserDefinedCommandsVisible>
</AjaxFormAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
    <PageWidgetPortable>
      <Id>ITENS</Id>
      <MasterWidgetId>CRITRIOSDESUGESTO</MasterWidgetId>
      <Title>Itens</Title>
      <Order>20</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>SimpleGrid</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<SimpleGridAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>false</CanUpdate>
  <CanInsert>false</CanInsert>
  <EntityViewName>CP_REQUISICOES.ANALISECOTACOES.GRID</EntityViewName>
  <Mode>0</Mode>
  <UserDefinedSelectColumnVisible>false</UserDefinedSelectColumnVisible>
  <UserDefinedPageSize>3</UserDefinedPageSize>
  <SystemFilterOnly>false</SystemFilterOnly>
  <DisplayRowCommand>true</DisplayRowCommand>
  <CompanyFilterMode>2</CompanyFilterMode>
  <UserDefinedCriteriaWhereClause>A.HANDLE IN (SELECT DISTINCT MIN(REQAGRUPADA.REQUISICAOHANDLE) HANDLE
                                 FROM CP_REQUISICAOAGRUPADAS REQAGRUPADA
                                 JOIN CP_REQUISICAOPRODUTOS REQPRODUTO ON REQAGRUPADA.REQUISICAOPRODUTO = REQPRODUTO.HANDLE
                                 JOIN CP_REQUISICAOCOTACOES REQCOTACOES ON REQPRODUTO.HANDLE = REQCOTACOES.COTACAO
                                WHERE REQPRODUTO.TIPO = 'C'
                                      AND REQPRODUTO.EMPRESA = @EMPRESA
                                      AND REQPRODUTO.STATUS = 1 
                                      AND REQPRODUTO.COMPRADOR = @CAMPO(COMPRADOR)
                                      AND REQPRODUTO.FORNECEDOR IS NOT NULL 
                                      AND REQCOTACOES.STATUS = 1
                                      AND REQCOTACOES.COMPRADOR = @CAMPO(COMPRADOR) 
                                      AND REQCOTACOES.DATAVALIDADE &gt;= @HOJE
                             GROUP BY REQPRODUTO.PRODUTO, REQPRODUTO.VARIACAO, REQPRODUTO.EHAGRUPAMENTO, REQPRODUTO.HANDLE)</UserDefinedCriteriaWhereClause>
  <ShowExport>false</ShowExport>
  <UserDefinedDisableRowSelection>false</UserDefinedDisableRowSelection>
</SimpleGridAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
    <PageWidgetPortable>
      <Id>COTAES</Id>
      <MasterWidgetId>ITENS</MasterWidgetId>
      <Title>Cotações</Title>
      <Order>30</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>SimpleGrid</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<SimpleGridAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>false</CanUpdate>
  <CanInsert>false</CanInsert>
  <EntityViewName>CP_REQUISICAOCOTACOES.ANALISECOTACOES.GRID</EntityViewName>
  <Mode>0</Mode>
  <UserDefinedSelectColumnVisible>false</UserDefinedSelectColumnVisible>
  <UserDefinedPageSize>10</UserDefinedPageSize>
  <SystemFilterOnly>false</SystemFilterOnly>
  <DisplayRowCommand>true</DisplayRowCommand>
  <CompanyFilterMode>2</CompanyFilterMode>
  <UserDefinedCriteriaWhereClause>A.COTACAO IN (SELECT REQUISICAOPRODUTO FROM CP_REQUISICAOAGRUPADAS REQAGRUPADA JOIN CP_REQUISICAOPRODUTOS REQPRODUTO ON REQAGRUPADA.REQUISICAOPRODUTO = REQPRODUTO.HANDLE
WHERE REQPRODUTO.STATUS = 1 AND REQPRODUTO.TIPO = 'C' AND REQUISICAOHANDLE = @CAMPO(HANDLE)) AND A.STATUS = 1 AND A.DATAVALIDADE &gt;= @HOJE</UserDefinedCriteriaWhereClause>
  <FormUrl>~/aga/a/suprimentos/cotacoes/DetalheDaCotacao.aspx</FormUrl>
  <ShowExport>false</ShowExport>
  <UserDefinedDisableRowSelection>false</UserDefinedDisableRowSelection>
</SimpleGridAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
    <PageWidgetPortable>
      <Id>PROPOSTAS</Id>
      <MasterWidgetId>CRITRIOSDESUGESTO</MasterWidgetId>
      <Title>Propostas</Title>
      <Order>40</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Fixed</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>SimpleGrid</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<SimpleGridAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>false</CanUpdate>
  <CanInsert>false</CanInsert>
  <EntityViewName>CP_COTACOESCAPAITENS.ANALISE_COTACAO_PROPOSTA.GRID</EntityViewName>
  <Mode>0</Mode>
  <UserDefinedSelectColumnVisible>false</UserDefinedSelectColumnVisible>
  <UserDefinedPageSize>10</UserDefinedPageSize>
  <SystemFilterOnly>false</SystemFilterOnly>
  <DisplayRowCommand>true</DisplayRowCommand>
  <CompanyFilterMode>1</CompanyFilterMode>
  <UserDefinedCriteriaWhereClause>A.HANDLE IN ( SELECT MIN(COTACAOCAPAITENS.HANDLE) FROM CP_COTACOESCAPAITENS COTACAOCAPAITENS
JOIN CP_REQUISICAOPRODUTOS REQPRODUTO ON COTACAOCAPAITENS.REQUISICAOPRODUTO = REQPRODUTO.HANDLE
JOIN CP_REQUISICAOCOTACOES REQCOTACOES ON REQPRODUTO.HANDLE = REQCOTACOES.COTACAO
WHERE (COTACAOCAPAITENS.COTACAOCAPA IN (@CAMPO(COTACOESCAPA)) OR -1 IN (@CAMPO(COTACOESCAPA)))
AND REQPRODUTO.TIPO = 'C'
AND REQPRODUTO.STATUS = 1
AND REQPRODUTO.COMPRADOR = @CAMPO(COMPRADOR)
AND REQPRODUTO.FORNECEDOR IS NOT NULL
AND REQCOTACOES.STATUS = 1
AND REQCOTACOES.COMPRADOR = @CAMPO(COMPRADOR)
AND REQCOTACOES.DATAVALIDADE &gt;= @HOJE
GROUP BY COTACAOCAPAITENS.FORNECEDOR, COTACAOCAPAITENS.COTACAOCAPA)</UserDefinedCriteriaWhereClause>
  <ShowExport>false</ShowExport>
  <UserDefinedDisableRowSelection>false</UserDefinedDisableRowSelection>
</SimpleGridAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
    <PageWidgetPortable>
      <Id>ITENSNAPROPOSTA</Id>
      <MasterWidgetId>PROPOSTAS</MasterWidgetId>
      <Title>Itens na proposta</Title>
      <Order>50</Order>
      <ShowTitle>true</ShowTitle>
      <PortletCssClass />
      <FontIcon />
      <Subtitle />
      <ChromeState>Normal</ChromeState>
      <PortletLayout>Default</PortletLayout>
      <WidgetTypeId>SimpleGrid</WidgetTypeId>
      <BootstrapCols>12</BootstrapCols>
      <XmlAttributes><![CDATA[<SimpleGridAttributes>
  <CanDelete>false</CanDelete>
  <CanUpdate>false</CanUpdate>
  <CanInsert>false</CanInsert>
  <EntityViewName>CP_REQUISICAOCOTACOES.ANALISE_COTACAO_PROPOSTA.GRID</EntityViewName>
  <Mode>0</Mode>
  <UserDefinedSelectColumnVisible>false</UserDefinedSelectColumnVisible>
  <UserDefinedPageSize>10</UserDefinedPageSize>
  <SystemFilterOnly>false</SystemFilterOnly>
  <DisplayRowCommand>true</DisplayRowCommand>
  <CompanyFilterMode>1</CompanyFilterMode>
  <UserDefinedCriteriaWhereClause>A.HANDLE IN (SELECT COTACOES.HANDLE
FROM CP_COTACOESCAPAITENS COTACAOCAPAITENS
JOIN CP_REQUISICAOCOTACOES COTACOES ON COTACAOCAPAITENS.REQUISICAOPRODUTO = COTACOES.COTACAO
WHERE COTACAOCAPAITENS.FORNECEDOR = @CAMPO(FORNECEDOR) AND COTACAOCAPAITENS.COTACAOCAPA = @CAMPO(COTACAOCAPA) AND COTACOES.STATUS = 1 AND COTACOES.DATAVALIDADE &gt;= @HOJE)</UserDefinedCriteriaWhereClause>
  <FormUrl>~/aga/a/suprimentos/cotacoes/DetalheDaCotacao.aspx</FormUrl>
  <ShowExport>false</ShowExport>
  <UserDefinedDisableRowSelection>true</UserDefinedDisableRowSelection>
</SimpleGridAttributes>
]]></XmlAttributes>
      <Level>Benner</Level>
    </PageWidgetPortable>
  </Widgets>
  <Resources>
    <PageResourcePortable>
      <Id>6B36342859784627BD66AC62FC9A87F8</Id>
      <ResourceType>JavaScript</ResourceType>
      <Content><![CDATA[$(() => {
    var pagina = Sys.WebForms.PageRequestManager.getInstance();
    
    if (!pagina.get_isInAsyncPostBack())
    {
        pagina.add_endRequest(incluirLegendaBotoesItens);
        pagina.add_endRequest(incluirLegendaBotoesPropostas);
    }
      
    incluirLegendaBotoesItens(); 
    incluirLegendaBotoesPropostas();
});


const incluirLegendaBotoesItens = () => {
    $("#ctl00_Main_ITENS_toolbar, #ctl00_Main_ITENS_footerCommands").find("> a").each((index, comando) => {
        var descricaoComando;
        if (comando.id == "top-CMD_ALTERARCRITERIOS") {
            descricaoComando = "Alterar critérios de sugestão";
        }
        else if (comando.id == "top-CMD_SELECIONARCOTACOESSUGERIDA") {
            descricaoComando = "Selecionar todas as cotações sugeridass";
        }
        else if (comando.id == "top-MAPA_ANALISE_COTACOES") {
            descricaoComando = "Mapa de analise de cotações";
        }
        $(comando).find("i").css("padding-left", "8px");
        
        if (!$(comando).attr("title"))
            $(comando).attr("title", descricaoComando);
    });  
};

const incluirLegendaBotoesPropostas = () => {
    $("#ctl00_Main_PROPOSTAS_toolbar, #ctl00_Main_PROPOSTAS_footerCommands").find("> a").each((index, comando) => {
        var descricaoComando;
        if (comando.id == "top-CMD_ALTERARCRITERIOS") {
            descricaoComando = "Alterar critérios de sugestão";
        }
        else if (comando.id == "top-MAPA_ANALISE_COTACOES") {
            descricaoComando = "Mapa de analise de cotações";
        }
        $(comando).find("i").css("padding-left", "8px");
        
        if (!$(comando).attr("title"))
            $(comando).attr("title", descricaoComando);
    });  
};]]></Content>
      <Level>Benner</Level>
    </PageResourcePortable>
    <PageResourcePortable>
      <Id>1755421A40884EDD940322B9C8C29A20</Id>
      <ResourceType>CSS</ResourceType>
      <Content><![CDATA[#ITENS th, td, #COTAES th, td, #PROPOSTAS th, td, #ITENSNAPROPOSTA th, td {
    white-space: nowrap !important;
}]]></Content>
      <Level>Benner</Level>
    </PageResourcePortable>
  </Resources>
</PagePortable>