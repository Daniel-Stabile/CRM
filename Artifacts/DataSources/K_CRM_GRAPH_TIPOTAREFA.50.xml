<?xml version="1.0"?>
<DataSourcePortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Identifier>K_CRM_GRAPH_TIPOTAREFA</Identifier>
  <Name>CRM_GRAPH_TIPOTAREFA</Name>
  <Content><![CDATA[<DataSourceDefinition>
  <FromSql Alias="A" SelectCommand="SELECT CAST(CAST(LEFT(DATENAME(MONTH,A.DATACONCLUSAO),3) AS VARCHAR) +'/'+ CAST(DATENAME(YEAR,A.DATACONCLUSAO) AS VARCHAR) AS VARCHAR) DATA,&#xD;&#xA;       COALESCE(TEL_REC.TELEF_RECEBIDO,0) TELEF_RECEBIDO,&#xD;&#xA;       COALESCE(TEL_REA.TELEF_REALIZADO,0) TELEF_REALIZADO,&#xD;&#xA;       COALESCE(ANOT.ANOTACAO,0) ANOTACAO,&#xD;&#xA;       COALESCE(TAREFA.TAREFA,0) TAREFA,&#xD;&#xA;       COALESCE(REUNIAO.REUNIAO,0) REUNIAO,&#xD;&#xA;       COALESCE(EMAIL.EMAIL,0) EMAIL,&#xD;&#xA;       COALESCE(VIS.VISITA,0) VISITA,&#xD;&#xA;       COALESCE(PVIS.PRIM_VISITA,0) PRIM_VISITA&#xD;&#xA;FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;JOIN K_CRM_PESSOAS B ON A.PESSOA = B.HANDLE&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) TELEF_RECEBIDO&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 2&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) TEL_REC ON TEL_REC.MES = MONTH(A.DATACONCLUSAO) AND TEL_REC.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) TELEF_REALIZADO&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 3&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) TEL_REA ON TEL_REA.MES = MONTH(A.DATACONCLUSAO) AND TEL_REA.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) ANOTACAO&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 4&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) ANOT ON ANOT.MES = MONTH(A.DATACONCLUSAO) AND ANOT.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) TAREFA&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 5&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) TAREFA ON TAREFA.MES = MONTH(A.DATACONCLUSAO) AND TAREFA.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) REUNIAO&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 6&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) REUNIAO ON REUNIAO.MES = MONTH(A.DATACONCLUSAO) AND REUNIAO.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) EMAIL&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 7&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) EMAIL ON EMAIL.MES = MONTH(A.DATACONCLUSAO) AND EMAIL.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) VISITA&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 8&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) VIS ON VIS.MES = MONTH(A.DATACONCLUSAO) AND VIS.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;LEFT JOIN (&#xD;&#xA;   SELECT MONTH(A.DATACONCLUSAO) MES ,YEAR(A.DATACONCLUSAO) ANO,COUNT(A.HANDLE) PRIM_VISITA&#xD;&#xA;   FROM K_CRM_TAREFAUSUARIO A&#xD;&#xA;   JOIN K_CRM_TAREFAS B ON A.TAREFA = B.HANDLE&#xD;&#xA;   WHERE B.TIPO = 9&#xD;&#xA;   GROUP BY MONTH(A.DATACONCLUSAO),YEAR(A.DATACONCLUSAO)) PVIS ON PVIS.MES = MONTH(A.DATACONCLUSAO) AND PVIS.ANO = YEAR(A.DATACONCLUSAO)&#xD;&#xA;WHERE 1=1&#xD;&#xA;AND A.DATACONCLUSAO IS NOT NULL&#xD;&#xA;AND @CRITERIOSELECAO&#xD;&#xA;GROUP BY YEAR(A.DATACONCLUSAO),&#xD;&#xA;MONTH(A.DATACONCLUSAO),&#xD;&#xA;DATENAME(MONTH,A.DATACONCLUSAO),&#xD;&#xA;DATENAME(YEAR,A.DATACONCLUSAO),&#xD;&#xA;TEL_REC.TELEF_RECEBIDO,&#xD;&#xA;       TEL_REA.TELEF_REALIZADO,&#xD;&#xA;       ANOT.ANOTACAO,&#xD;&#xA;       TAREFA.TAREFA,&#xD;&#xA;       REUNIAO.REUNIAO,&#xD;&#xA;       EMAIL.EMAIL,&#xD;&#xA;       VIS.VISITA,&#xD;&#xA;       PVIS.PRIM_VISITA&#xD;&#xA;ORDER BY YEAR(A.DATACONCLUSAO),&#xD;&#xA;MONTH(A.DATACONCLUSAO)&#xD;&#xA;" />
  <Fields>
    <Field Alias="DATA" From="A" Path="DATA" />
    <Field Alias="TELEF_RECEBIDO" From="A" Path="TELEF_RECEBIDO" />
    <Field Alias="TELEF_REALIZADO" From="A" Path="TELEF_REALIZADO" />
    <Field Alias="ANOTACAO" From="A" Path="ANOTACAO" />
    <Field Alias="TAREFA" From="A" Path="TAREFA" />
    <Field Alias="REUNIAO" From="A" Path="REUNIAO" />
    <Field Alias="EMAIL" From="A" Path="EMAIL" />
    <Field Alias="VISITA" From="A" Path="VISITA" />
    <Field Alias="PRIM_VISITA" From="A" Path="PRIM_VISITA" />
  </Fields>
</DataSourceDefinition>
]]></Content>
  <Level>Cliente</Level>
  <ContemDadosPessoaisLgpd>false</ContemDadosPessoaisLgpd>
  <ExibirNaApi>true</ExibirNaApi>
</DataSourcePortable>