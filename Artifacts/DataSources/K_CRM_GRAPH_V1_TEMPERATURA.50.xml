<?xml version="1.0"?>
<DataSourcePortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Identifier>K_CRM_GRAPH_V1_TEMPERATURA</Identifier>
  <Name>CRM_GRAPH_V1_TEMPERATURA</Name>
  <Content><![CDATA[<DataSourceDefinition>
  <FromSql Alias="A" SelectCommand="SELECT&#xD;&#xA;     CAST(CAST(LEFT(DATENAME(MONTH,A.DATAFECHAMENTO),3) AS VARCHAR) +'/'+ CAST(DATENAME(YEAR,A.DATAFECHAMENTO) AS VARCHAR) AS VARCHAR) MES,&#xD;&#xA;     ROUND(COALESCE(SUM(DISTINCT(TAB_NEUTRO.VALOR)),0),2) MORNO,&#xD;&#xA;     ROUND(COALESCE(SUM(DISTINCT(TAB_FIRME.VALOR)),0),2) QUENTE,&#xD;&#xA;     ROUND(COALESCE(SUM(DISTINCT(TAB_RISCO.VALOR)),0),2) FRIO,&#xD;&#xA;     ROUND(COALESCE(SUM(DISTINCT(TAB_STANDBY.VALOR)),0),2) STANDBY&#xD;&#xA;FROM K_CRM_PESSOAOPORTUNIDADES A&#xD;&#xA;JOIN K_CRM_PESSOAOPORTUNIDADESPROD C ON C.OPORTUNIDADE = A.HANDLE&#xD;&#xA;JOIN K_CRM_FASESOPORTUNIDADE B ON A.STATUSOPORTUNIDADE = B.HANDLE&#xD;&#xA;LEFT JOIN (SELECT&#xD;&#xA;        AA.VALORTOTAL VALOR, AA.HANDLE&#xD;&#xA;     FROM K_CRM_PESSOAOPORTUNIDADES AA&#xD;&#xA;     JOIN K_CRM_FASESOPORTUNIDADE AB ON AA.STATUSOPORTUNIDADE = AB.HANDLE&#xD;&#xA;     WHERE AA.TEMPERATURA = 1&#xD;&#xA;    ) TAB_NEUTRO ON TAB_NEUTRO.HANDLE = A.HANDLE&#xD;&#xA;LEFT JOIN (SELECT&#xD;&#xA;        AA.VALORTOTAL VALOR, AA.HANDLE&#xD;&#xA;     FROM K_CRM_PESSOAOPORTUNIDADES AA&#xD;&#xA;     JOIN K_CRM_FASESOPORTUNIDADE AB ON AA.STATUSOPORTUNIDADE = AB.HANDLE&#xD;&#xA;     WHERE AA.TEMPERATURA = 2&#xD;&#xA;    ) TAB_FIRME ON TAB_FIRME.HANDLE = A.HANDLE&#xD;&#xA;LEFT JOIN (SELECT&#xD;&#xA;        AA.VALORTOTAL VALOR, AA.HANDLE&#xD;&#xA;     FROM K_CRM_PESSOAOPORTUNIDADES AA&#xD;&#xA;     JOIN K_CRM_FASESOPORTUNIDADE AB ON AA.STATUSOPORTUNIDADE = AB.HANDLE&#xD;&#xA;     WHERE AA.TEMPERATURA = 3&#xD;&#xA;    ) TAB_RISCO ON TAB_RISCO.HANDLE = A.HANDLE&#xD;&#xA;LEFT JOIN (SELECT&#xD;&#xA;        AA.VALORTOTAL VALOR, AA.HANDLE&#xD;&#xA;     FROM K_CRM_PESSOAOPORTUNIDADES AA&#xD;&#xA;     JOIN K_CRM_FASESOPORTUNIDADE AB ON AA.STATUSOPORTUNIDADE = AB.HANDLE&#xD;&#xA;     WHERE AA.TEMPERATURA = 4&#xD;&#xA;    ) TAB_STANDBY ON TAB_STANDBY.HANDLE = A.HANDLE&#xD;&#xA;WHERE A.STATUS IN (1,2,14)&#xD;&#xA;AND @CRITERIOSELECAO&#xD;&#xA;GROUP BY YEAR(A.DATAFECHAMENTO),&#xD;&#xA;MONTH(A.DATAFECHAMENTO),&#xD;&#xA;DATENAME(MONTH,A.DATAFECHAMENTO),&#xD;&#xA;DATENAME(YEAR,A.DATAFECHAMENTO)&#xD;&#xA;" />
  <Fields>
    <Field Alias="MES" From="A" Path="MES" />
    <DecimalField Alias="MORNO" From="A" Path="MORNO" FieldDecimalsFormat="0" />
    <DecimalField Alias="QUENTE" From="A" Path="QUENTE" FieldDecimalsFormat="0" />
    <DecimalField Alias="FRIO" From="A" Path="FRIO" FieldDecimalsFormat="0" />
    <DecimalField Alias="STANDBY" From="A" Path="STANDBY" FieldDecimalsFormat="0" />
  </Fields>
</DataSourceDefinition>
]]></Content>
  <Level>Cliente</Level>
  <ContemDadosPessoaisLgpd>false</ContemDadosPessoaisLgpd>
  <ExibirNaApi>true</ExibirNaApi>
</DataSourcePortable>