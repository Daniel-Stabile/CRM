<?xml version="1.0"?>
<DataSourcePortable xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Identifier>K_CRM_DADOS_FATURAMENTO_ANUAL</Identifier>
  <Name>Dados Faturamento Anual</Name>
  <Content><![CDATA[<DataSourceDefinition>
  <FromSql Alias="A" SelectCommand="SELECT 'VALORTOTAL' TEXTO, COALESCE(SUM(A.VALORTOTAL),SUM(A.VALORTOTAL),0) VALOR&#xD;&#xA;FROM K_CRM_PESSOAOPORTUNIDADES A&#xD;&#xA;JOIN K_CRM_PESSOAS B ON A.PESSOA = B.HANDLE&#xD;&#xA;WHERE B.FASE = 5&#xD;&#xA;AND B.CLIENTEDESDE IS NOT NULL&#xD;&#xA;AND DATEDIFF(YEAR,B.CLIENTEDESDE,GETDATE()) &gt;= 1&#xD;&#xA;AND A.STATUS = 10&#xD;&#xA;AND YEAR(A.DATAFECHAMENTO) = YEAR(GETDATE())&#xD;&#xA;AND A.RESPONSAVEL = @USUARIO&#xD;&#xA;&#xD;&#xA;UNION ALL&#xD;&#xA;&#xD;&#xA;SELECT 'VALORSAAS' TEXTO, COALESCE(SUM(VALORSAAS),SUM(VALORSAAS),0) VALOR&#xD;&#xA;FROM K_CRM_PESSOAOPORTUNIDADES A&#xD;&#xA;JOIN K_CRM_PESSOAS B ON A.PESSOA = B.HANDLE&#xD;&#xA;WHERE B.FASE = 5&#xD;&#xA;AND B.CLIENTEDESDE IS NOT NULL&#xD;&#xA;AND DATEDIFF(YEAR,B.CLIENTEDESDE,GETDATE()) &gt;= 1&#xD;&#xA;AND A.STATUS = 10&#xD;&#xA;AND YEAR(A.DATAFECHAMENTO) = YEAR(GETDATE())&#xD;&#xA;AND A.RESPONSAVEL = @USUARIO&#xD;&#xA;&#xD;&#xA;UNION ALL&#xD;&#xA;&#xD;&#xA;SELECT 'VALORRECORRENTE' TEXTO, COALESCE(SUM(RECORRENTE),SUM(RECORRENTE),0) VALOR&#xD;&#xA;FROM K_CRM_PESSOAOPORTUNIDADES A&#xD;&#xA;JOIN K_CRM_PESSOAS B ON A.PESSOA = B.HANDLE&#xD;&#xA;WHERE B.FASE = 5&#xD;&#xA;AND B.CLIENTEDESDE IS NOT NULL&#xD;&#xA;AND DATEDIFF(YEAR,B.CLIENTEDESDE,GETDATE()) &gt;= 1&#xD;&#xA;AND A.STATUS = 10&#xD;&#xA;AND YEAR(A.DATAFECHAMENTO) = YEAR(GETDATE())&#xD;&#xA;AND A.RESPONSAVEL = @USUARIO&#xD;&#xA;" />
  <Fields>
    <Field Alias="TEXTO" From="A" Path="TEXTO" />
    <DecimalField Alias="VALOR" From="A" Path="VALOR" FieldDecimalsFormat="0" />
  </Fields>
</DataSourceDefinition>
]]></Content>
  <Level>Cliente</Level>
  <ContemDadosPessoaisLgpd>false</ContemDadosPessoaisLgpd>
  <ExibirNaApi>true</ExibirNaApi>
</DataSourcePortable>